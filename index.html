<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Plan de estudios ¬∑ Carrera de Derecho 157-1</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;700&display=swap" rel="stylesheet">
<style>
:root{
  /* Tema base */
  --bg:#0e1117; --panel:#151a23; --ink:#e9f0ff; --muted:#9fb0c9; --line:#263041;
  --accent:#59d6ff; --accent-2:#8b7dff; --accent-3:#ffb35a;

  /* Paleta por tipo (cuerpo del tile) */
  --type-inst:#36c48f;       /* instrumentales */
  --type-bas-esp:#8b7dff;    /* b√°sicas espec√≠ficas */
  --type-esp:#59a6ff;        /* espec√≠ficas */
  --type-comp:#ffa554;       /* complementarias */

  --approved-brightness:1.12;
  --strike:#b90f2e;          /* tachado */
  --tile-border:#2b3547;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; background:var(--bg); color:var(--ink);
  font-family:"Montserrat",system-ui,Segoe UI,Roboto,Inter,Arial,sans-serif;
}

/* ====== ENCABEZADO HERO ====== */
.hero{
  position:sticky; top:0; z-index:20;
  background:
    linear-gradient(135deg, rgba(89,214,255,.18), rgba(139,125,255,.12)),
    linear-gradient(180deg, rgba(21,26,35,.98), rgba(21,26,35,.8));
  border-bottom:1px solid var(--line);
  backdrop-filter:saturate(130%) blur(8px);
}
.hero-inner{
  max-width:1100px; margin:0 auto; padding:1rem .9rem;
}
.kicker{
  letter-spacing:.25em; text-transform:uppercase; font-size:.76rem; color:var(--muted);
}
.title{
  margin:.25rem 0 .2rem; font-weight:800;
  font-size:clamp(1.15rem,4.8vw,2rem);
}
.subline{
  color:var(--muted); font-size:.92rem;
}
.divider{
  height:3px; margin:.8rem 0 0;
  background:linear-gradient(90deg, var(--accent), var(--accent-2), var(--accent-3));
  border-radius:2px;
}

/* ====== TOPBAR USUARIO ====== */
.topbar{
  display:flex; align-items:center; justify-content:space-between;
  max-width:1100px; margin:.4rem auto .6rem; padding:0 .9rem;
}
.badge{
  display:inline-flex; gap:.5rem; align-items:center;
  font-size:.85rem; color:#d5e1ff; background:#0f1520;
  border:1px solid var(--line); padding:.4rem .6rem; border-radius:.6rem;
}
.btn{
  appearance:none; border:none; cursor:pointer; border-radius:.6rem;
  padding:.55rem .85rem; font-weight:800; letter-spacing:.2px;
  color:#001018; background:var(--accent);
}
.btn:hover{filter:brightness(1.08)}
.btn-ghost{background:#0f1520; color:var(--ink); border:1px solid var(--line)}

/* ====== OVERLAY LOGIN ====== */
.overlay{position:fixed; inset:0; display:grid; place-items:center; background:rgba(0,0,0,.65); z-index:99}
.card{
  width:min(92vw,520px); background:var(--panel); border:1px solid var(--line);
  border-radius:1rem; padding:1rem .9rem 1.1rem; box-shadow:0 24px 80px rgba(0,0,0,.45);
}
.card h2{margin:.4rem 0 1rem; text-align:center; font-size:1rem; color:#d7e4ff}
label{display:block; font-size:.92rem; color:var(--muted); margin:.45rem 0 .25rem}
input{
  width:100%; padding:.8rem .9rem; border-radius:.7rem; border:1px solid var(--line);
  background:#0f1520; color:#fff; outline:none;
}
input:focus{border-color:var(--accent)}
.action{margin-top:.8rem}

/* ====== LAYOUT A√ëOS ====== */
.main{max-width:1100px; margin:0 auto; padding:1rem .9rem 3rem}
.year{
  background:var(--panel); border:1px solid var(--line);
  border-radius:1rem; padding:.85rem; margin:.8rem 0;
}
.year h3{
  text-align:center; margin:.2rem 0 .8rem; letter-spacing:.4px;
  color:#fff; font-size:1rem;
}

/* Grid de materias (mobile-first) */
.grid{
  display:grid; gap:.65rem;
  grid-template-columns:repeat(2,minmax(0,1fr));
}
@media (min-width:640px){ .grid{grid-template-columns:repeat(3,1fr)} }
@media (min-width:960px){ .grid{grid-template-columns:repeat(4,1fr)} }

/* ====== TILE ====== */
.tile{
  position:relative; overflow:hidden; border-radius:.9rem; user-select:none; cursor:pointer;
  background:#101522; border:1px solid var(--tile-border);
  display:grid; grid-template-rows:auto 1fr; min-height:120px;
  box-shadow:0 10px 28px rgba(0,0,0,.22); transition:transform .08s ease, box-shadow .2s ease;
}
.tile:hover{transform:translateY(-2px); box-shadow:0 16px 34px rgba(0,0,0,.28)}
.tile.locked{cursor:not-allowed; opacity:.58; filter:saturate(.75) contrast(.9)}
.tile.locked:hover{transform:none; box-shadow:0 10px 28px rgba(0,0,0,.22)}

/* Franja superior (sigla) */
.tile .code{
  display:block; text-align:center; font-weight:800; color:#061019; letter-spacing:.3px;
  padding:.38rem .5rem; background:rgba(255,255,255,.86);
  /* l√≠nea separadora sutil */
  box-shadow:inset 0 -1px 0 rgba(0,0,0,.08);
  font-size:.88rem;
}

/* Cuerpo (nombre) por tipo - degrad√© moderno */
.tile.type-inst  .name{background:linear-gradient(180deg, rgba(54,196,143,1), rgba(54,196,143,.85))}
.tile.type-bas-esp .name{background:linear-gradient(180deg, rgba(139,125,255,1), rgba(139,125,255,.85))}
.tile.type-esp   .name{background:linear-gradient(180deg, rgba(89,166,255,1), rgba(89,166,255,.85))}
.tile.type-comp  .name{background:linear-gradient(180deg, rgba(255,165,84,1), rgba(255,165,84,.85))}

.name{
  display:grid; place-items:center; padding:.75rem .6rem; text-align:center;
  color:#041018; font-weight:800; line-height:1.15; font-size:.98rem;
}

/* Badge 'CERE' */
.badges{position:absolute; right:8px; bottom:8px; display:flex; gap:6px}
.badge{background:#0f1520; color:#d2deff; padding:.2rem .45rem; font-size:.72rem; border-radius:.6rem; border:1px solid var(--line)}

/* Aprobada */
.tile.approved .name, .tile.approved .code{filter:brightness(var(--approved-brightness))}
.tile.approved::after{
  content:""; position:absolute; left:0; top:50%; width:100%; height:3px; background:var(--strike);
  transform:translateY(-50%) rotate(-45deg); transform-origin:center;
}

/* ====== MODAL FELICIDADES ====== */
.modal{position:fixed; inset:0; display:none; place-items:center; background:rgba(0,0,0,.55); z-index:98}
.modal.show{display:grid}
.modal .paper{
  width:min(92vw,520px); text-align:center; background:var(--panel);
  border:1px solid var(--line); border-radius:1rem; padding:1rem 1.1rem;
  box-shadow:0 24px 80px rgba(0,0,0,.45); font-weight:800; letter-spacing:.2px;
}

/* Utilidades */
.hidden{display:none!important}
</style>
</head>
<body>

<!-- HERO -->
<header class="hero">
  <div class="hero-inner">
    <div class="kicker">UAGRM ¬∑ Facultad de Ciencias Jur√≠dicas</div>
    <div class="title">PLAN DE ESTUDIOS ¬∑ CARRERA DE DERECHO 157-1</div>
    <div class="subline">Malla interactiva con prerrequisitos, progreso guardado y vista mobile-first</div>
    <div class="divider"></div>
  </div>
  <div class="topbar">
    <div class="badge" id="userBadge">Estudiante: ‚Äî ¬∑ Registro: ‚Äî</div>
    <div class="actions">
      <button class="btn btn-ghost" id="resetBtn" type="button">Reiniciar progreso</button>
    </div>
  </div>
</header>

<main class="main">
  <!-- A√±os 1‚Äì5 -->
  <section class="year"><h3>Primer A√±o</h3><div class="grid" data-year="1"></div></section>
  <section class="year"><h3>Segundo A√±o</h3><div class="grid" data-year="2"></div></section>
  <section class="year"><h3>Tercer A√±o</h3><div class="grid" data-year="3"></div></section>
  <section class="year"><h3>Cuarto A√±o</h3><div class="grid" data-year="4"></div></section>
  <section class="year"><h3>Quinto A√±o</h3><div class="grid" data-year="5"></div></section>
</main>

<!-- LOGIN -->
<div class="overlay" id="login">
  <div class="card">
    <h2>FACULTAD DE CIENCIAS JUR√çDICAS, POL√çTICAS, SOCIALES Y RELACIONES INTERNACIONALES</h2>
    <label>Estudiante</label>
    <input id="inName" type="text" placeholder="Nombre completo" />
    <label>Registro</label>
    <input id="inReg" type="text" placeholder="N√∫mero de registro" />
    <div class="action">
      <button class="btn" id="startBtn" type="button">Comenzar</button>
    </div>
  </div>
</div>

<!-- MODAL FELICIDADES -->
<div class="modal" id="congrats">
  <div class="paper">üéâ ¬°FELICIDADES! Has aprobado toda la malla curricular.</div>
</div>

<script>
/* =======================
   DATA ‚Äî DERECHO 157-1
   (DER404 SOLO REQUIERE DER202, como pediste)
   ======================= */
const COURSES = [
  // 1er A√±o
  {id:'DER100', name:'Introducci√≥n al Derecho', year:1, type:'inst', prereq:[]},
  {id:'DER101', name:'Derecho Romano e Historia del Derecho Boliviano', year:1, type:'bas-esp', prereq:[]},
  {id:'DER102', name:'Sociolog√≠a General y Jur√≠dica', year:1, type:'inst', prereq:[]},
  {id:'DER103', name:'Ciencia Pol√≠tica e Historia del Pensamiento Pol√≠tico', year:1, type:'bas-esp', prereq:[]},
  {id:'DER104', name:'Derecho Civil I y II (Personas y Derechos Reales)', year:1, type:'esp', prereq:[]},
  {id:'DER105', name:'Econom√≠a Pol√≠tica', year:1, type:'comp', prereq:[]},
  {id:'DER106', name:'Filosof√≠a General y del Derecho', year:1, type:'bas-esp', prereq:[]},
  {id:'DER107', name:'Metodolog√≠a de la Investigaci√≥n Social y Jur√≠dica', year:1, type:'bas-esp', prereq:[]},

  // 2do A√±o
  {id:'DER200', name:'Derecho Constitucional y Procedimientos Constitucionales', year:2, type:'esp', prereq:['DER100','DER101','DER102','DER103']},
  {id:'DER201', name:'Derechos Humanos, su Procedimiento y Derecho Ind√≠gena', year:2, type:'esp', prereq:['DER100']},
  {id:'DER202', name:'Derecho Administrativo y su Procedimiento', year:2, type:'esp', prereq:['DER100']},
  {id:'DER203', name:'Derecho Civil III (Obligaciones)', year:2, type:'esp', prereq:['DER104']},
  {id:'DER204', name:'Medicina Legal', year:2, type:'esp', prereq:['DER104']},
  {id:'DER205', name:'Derecho Penal I', year:2, type:'esp', prereq:['DER105']},
  {id:'DER206', name:'Criminolog√≠a', year:2, type:'esp', prereq:['DER105']},
  {id:'DER207', name:'Ley del √ìrgano Judicial, √âtica y Taller de Expresi√≥n', year:2, type:'comp', prereq:['DER106']},

  // 3er A√±o
  {id:'DER300', name:'Derecho Laboral, su Procedimiento y Pr√°ctica Forense', year:3, type:'esp', prereq:['DER200']},
  {id:'DER301', name:'Derecho Financiero, Tributario y Aduanero y su Procedimiento', year:3, type:'esp', prereq:['DER105']}, // tu pedido: Finanzas por DER105
  {id:'DER302', name:'Derecho del Medio Ambiente y su Procedimiento', year:3, type:'esp', prereq:['DER202']},
  {id:'DER303', name:'Derecho Civil IV (Contratos)', year:3, type:'esp', prereq:['DER203']},
  {id:'DER304', name:'Derecho Procesal Civil y Pr√°ctica Forense', year:3, type:'esp', prereq:['DER203']},
  {id:'DER305', name:'Derecho Penal II', year:3, type:'esp', prereq:['DER205']},
  {id:'DER306', name:'Derecho Procesal Penal y Pr√°ctica Forense', year:3, type:'esp', prereq:['DER205']},

  // 4to A√±o
  {id:'DER400', name:'Derecho a la Seguridad Social, Procedimiento y Pr√°ctica Forense', year:4, type:'esp', prereq:['DER300']},
  {id:'DER401', name:'Derecho Comercial y Empresarial', year:4, type:'esp', prereq:['DER301']},
  {id:'DER402', name:'Derecho Agrario y Procedimiento Administrativo Agrario', year:4, type:'esp', prereq:['DER302']},
  {id:'DER403', name:'Derecho Civil V (Sucesiones)', year:4, type:'esp', prereq:['DER303']},
  {id:'DER404', name:'Derecho Bancario, Burs√°til y Cooperativo', year:4, type:'esp', prereq:['DER202']}, // <-- CORREGIDO
  {id:'DER405', name:'Derecho Inform√°tico', year:4, type:'esp', prereq:['DER304']},
  {id:'DER406', name:'Derecho Internacional P√∫blico y Privado', year:4, type:'esp', prereq:['DER305','DER306']},
  {id:'DER407', name:'Metodolog√≠a y Taller de Tesis', year:4, type:'comp', prereq:['DER107']},

  // 5to A√±o
  {id:'DER500', name:'Derecho Auton√≥mico y Municipal', year:5, type:'comp', prereq:['DER202']},
  {id:'DER501', name:'Derecho Procesal Agrario y su Proceso Oral', year:5, type:'esp', prereq:['DER402']},
  {id:'DER502', name:'Derecho Minero y Petrolero', year:5, type:'esp', prereq:['DER302']},
  {id:'DER503', name:'Derecho de Familia, Ni√±ez, Adolescencia y Violencia', year:5, type:'esp', prereq:['DER403']},
  {id:'DER504', name:'Taller y Pr√°ctica Forense Civil', year:5, type:'comp', prereq:['DER303']},
  {id:'DER505', name:'Taller y Pr√°ctica Forense Penal y Sistema Penitenciario', year:5, type:'comp', prereq:['DER306']},
  {id:'DER506', name:'M√©todos Alternativos de Resoluci√≥n de Conflictos', year:5, type:'comp', prereq:['DER407']},
];

/* ======== Estado y persistencia ======== */
const $ = s => document.querySelector(s);
const $$ = s => [...document.querySelectorAll(s)];
let COMPLETED = new Set();
let STORAGE_KEY = ""; // malla_derecho_1571_<registro>
const CHILDREN = {};  // padre -> [hijos], para cascada

// Construye grafo de dependencias (hijos)
COURSES.forEach(c => c.prereq.forEach(p => (CHILDREN[p] ??= []).push(c.id)));

/* ======== UI ======== */
function renderAll(){
  // Limpia contenedores por a√±o y rellena
  $$(".grid").forEach(g => g.innerHTML = "");
  COURSES.forEach(c => {
    const grid = document.querySelector(`.grid[data-year="${c.year}"]`);
    const tile = document.createElement("div");
    tile.className = `tile type-${typeClass(c.type)}`;
    tile.dataset.id = c.id;

    const isDone = COMPLETED.has(c.id);
    const unlocked = isDone || c.prereq.every(p => COMPLETED.has(p));
    if (isDone) tile.classList.add("approved");
    if (!unlocked) tile.classList.add("locked");

    tile.innerHTML = `
      <span class="code">${c.id}</span>
      <div class="name">${c.name}</div>
      <div class="badges"><span class="badge">CERE</span></div>
    `;

    tile.addEventListener("click", () => {
      if (tile.classList.contains("locked")) return;

      if (COMPLETED.has(c.id)) {
        // Desmarcar + cascada
        COMPLETED.delete(c.id);
        unapproveCascade(c.id);
      } else {
        // Marcar
        COMPLETED.add(c.id);
      }
      save();
      const all = COURSES.every(x => COMPLETED.has(x.id));
      renderAll();
      if (all) showCongrats();
    });

    grid.appendChild(tile);
  });
}
function typeClass(t){
  switch(t){
    case 'inst': return 'inst';
    case 'bas-esp': return 'bas-esp';
    case 'esp': return 'esp';
    case 'comp': return 'comp';
    default: return 'esp';
  }
}

/* ======== Cascada ======== */
function unapproveCascade(root){
  const stack = [root];
  const visited = new Set();
  while (stack.length){
    const cur = stack.pop();
    if (visited.has(cur)) continue;
    visited.add(cur);
    (CHILDREN[cur] || []).forEach(ch => {
      if (COMPLETED.has(ch)) {
        COMPLETED.delete(ch);
        stack.push(ch);
      }
    });
  }
}

/* ======== Persistencia ======== */
function save(){ localStorage.setItem(STORAGE_KEY, JSON.stringify([...COMPLETED])); }
function load(){
  const raw = localStorage.getItem(STORAGE_KEY);
  COMPLETED = new Set(raw ? JSON.parse(raw) : []);
}

/* ======== Login + acciones ======== */
document.addEventListener("DOMContentLoaded", () => {
  // Oculta modal siempre al inicio
  $("#congrats").classList.remove("show");

  $("#startBtn").addEventListener("click", () => {
    const name = $("#inName").value.trim();
    const reg  = $("#inReg").value.trim();
    if (!name || !reg) { alert("Complet√° Estudiante y Registro"); return; }

    STORAGE_KEY = `malla_derecho_1571_${reg}`;
    load();

    $("#login").classList.add("hidden");
    $("#userBadge").textContent = `Estudiante: ${name} ¬∑ Registro: ${reg}`;
    renderAll();
  });

  $("#resetBtn").addEventListener("click", () => {
    if (!STORAGE_KEY) return;
    if (confirm("¬øBorrar todo tu progreso guardado?")) {
      localStorage.removeItem(STORAGE_KEY);
      COMPLETED.clear();
      renderAll();
    }
  });
});

/* ======== Modal felicidades ======== */
function showCongrats(){
  const m = $("#congrats");
  m.classList.add("show");
  setTimeout(() => m.classList.remove("show"), 5000);
}
</script>
</body>
</html>
